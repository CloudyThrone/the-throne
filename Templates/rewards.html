{% extends 'base.html' %} {% set body_class = "bg-float" %} {% block content %}

<style>
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(to right, #1f1c2c, #928dab);
        color: #fff;
        margin: 0;
        padding: 0;
    }

    .main-content {
        display: flex;
        min-height: 100vh;
    }

    .sidebar {
        background-color: #2a2a72;
        padding: 2rem 1rem;
        width: 220px;
        color: white;
        box-shadow: 2px 0 10px rgba(0,0,0,0.4);
    }

    .sidebar h3 {
        margin-bottom: 2rem;
        font-size: 1.2rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        color: gold;
    }

    .sidebar a {
        display: block;
        margin: 1rem 0;
        text-decoration: none;
        color: #f0f0f0;
        font-weight: bold;
        transition: 0.3s;
    }

    .sidebar a:hover {
        color: #a87030;
    }

    .container {
        flex-grow: 1;
        padding: 2rem;
        display: flex;
        flex-direction: column;
        gap: 2rem;
    }

    section {
        background: rgba(255, 255, 255, 0.05);
        padding: 1.5rem;
        border-radius: 1rem;
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    h1, h2, h3 {
        color: #a87030;
        margin-bottom: 1rem;
    }

    ul, p {
        color: #ddd;
    }

    .reward-table ul li {
        padding: 0.4rem 0;
    }

    .leaderboard-tables {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 1rem;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        background: rgba(255,255,255,0.05);
        color: white;
        border-radius: 8px;
        overflow: hidden;
    }

    table th, table td {
        padding: 0.6rem;
        text-align: center;
        border-bottom: 1px solid #444;
    }

    .counter-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 1rem;
        margin-top: 1rem;
    }

    .counter-box {
        background: #3b3b98;
        padding: 1rem;
        border-radius: 0.75rem;
        text-align: center;
        box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }

    .counter-box p {
        margin: 0;
        font-weight: bold;
    }

    .counter-box span {
        font-size: 1.5rem;
        color: #ffd700;
    }

    .crowns {
        display: flex;
        gap: 1rem;
        font-size: 2rem;
        justify-content: center;
        margin-top: 1rem;
    }

    .crown-box {
        background: rgba(255,255,255,0.1);
        padding: 0.75rem 1rem;
        border-radius: 0.75rem;
    }

    #announcement-feed ul li {
        margin-bottom: 0.8rem;
    }
</style><div class="main-content">
    <aside class="sidebar">
        <h3>ğŸ†</h3>
        <a href="/"><i class="fa-solid fa-house"></i> Home</a>
        <a href="/dashboard"><i class="fa-solid fa-gauge"></i> Dashboard</a>
        <a href="/rewards"><i class="fa-solid fa-medal"></i> Rewards</a>
        <a href="/withdraw"><i class="fa-solid fa-money-bill-wave"></i> Withdraw</a>
    </aside><div class="container">
    <!-- 1. Intro & Reward Instructions -->
    <section class="intro">
        <h1>ğŸ‰ Reward & Promotion ğŸ‰</h1>
        <p>
            Earn exciting cash and Mystery boxÂ  rewards by hitting your referral goals!
            Submit a screenshot of your achieved goal to our email or social media platforms to claim your instant reward before the timer resets âŒ›.
            The overall champion of the day world wide is awarded a daily crown and once you acquire three crown counts a grand cash reward is awarded to you, Hurry up to be the daily crowned champion.
        </p>
    </section>

    <!-- 2. Static Reward Table -->
    <section class="reward-table">
        <h2>ğŸ’° Referral Goals & Rewards</h2>
        <ul>
            <li>ğŸ¯ Daily Champion: 5 invites/day = KES 400 (Ksh 250 + free Ksh 150)</li>
            <li>ğŸ¯ Weekly Conqueror: 30 invites/week = KES 2,500 (Ksh 1500 + free Ksh 1,000)</li>
            <li>ğŸ¯ Monthly Royalty: 100 invites/month = Silver Mystery cashÂ </li>
            <li>ğŸ¯ Yearly Legend: 1000 invites/year = Golden Mystery cashÂ </li>
        </ul>
    </section>

    <!-- 3. Top Referrers Leaderboard -->
    <section class="leaderboard">
        <h2>ğŸ† Top 3 Referrers(Near you)</h2>
        <div class="leaderboard-tables">
            {% for period in ['day', 'week', 'month', 'year'] %}
                <div class="board">
                    <h3>This {{ period.title() }}</h3>
                    <table id="top-{{ period }}-table">
                        <tr><th>Rank</th><th>User</th><th>Invites</th></tr>
                        {% if top_inviter_tracker[period] %}
                            {% for user in top_inviter_tracker[period] %}
                            <tr>
                                <td>{{ loop.index }}</td>
                                <td>{{ user.username }}</td>
                                <td>{{ user.invite_count }}</td>
                            </tr>
                            {% endfor %}
                        {% else %}
                            <tr><td colspan="3">No data</td></tr>
                        {% endif %}
                    </table>
                </div>
            {% endfor %}
        </div>
    </section>

    <!-- 4. Personal Invitee Counter -->
    <section class="personal-counter">
        <h2>ğŸ“ˆ Your Invite Stats</h2>
        <p>Today's invites: <span id="my-invites-today">{{ my_invites.today }}</span></p>
        <p>âŒ› Reconfigures in: <span id="day-countdown">Loading...</span></p>
        <div class="counter-row">
            <div class="counter-box">
                <p>Today</p>
                <span id="today-count">{{ my_invites.today }}</span>
            </div>
            <div class="counter-box">
                <p>This Week</p>
                <span id="week-count">{{ my_invites.week }}</span>
            </div>
            <div class="counter-box">
                <p>This Month</p>
                <span id="month-count">{{ my_invites.month }}</span>
            </div>
            <div class="counter-box">
                <p>This Year</p>
                <span id="year-count">{{ my_invites.year }}</span>
            </div>
        </div>
    </section>

    <!-- 5. Crown Box Tracker -->
    <section class="crown-tracker">
        <h2>ğŸ‘‘ Daily Crown</h2>
        <div class="crowns">
            {% for i in range(1, 4) %}
                <span class="crown-box" id="crown-{{ i }}">
                    {% if i <= user_crowns %}ğŸ‘‘{% else %}â¬œ{% endif %}
                </span>
            {% endfor %}
        </div>
    </section>

    <!-- 6. Announcement Section -->
    <section class="announcements">
        <h2>ğŸ“¢ Announcements</h2>
        <div id="announcement-feed">
            {% if announcements %}
                <ul>
                    {% for a in announcements %}
                    <li>
                        {% if a.title %}<strong>{{ a.title }}</strong> â€” {% endif %}
                        {{ a.body }} <br>
                        <small>{{ a.timestamp.strftime('%Y-%m-%d %H:%M') }}</small>
                    </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No announcements yet.</p>
            {% endif %}
        </div>
    </section>
</div>

</div><script src="{{ url_for('static', filename='js/reward.js') }}"></script>{% endblock %}